{"remainingRequest":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\babel-loader\\lib\\index.js!D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\src\\views\\Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\src\\views\\Main.vue","mtime":1626078968997},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1625218015435},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\babel-loader\\lib\\index.js","mtime":1625218015245},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1625218015435},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\vue-loader\\lib\\index.js","mtime":1625218023348}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.bind\";\nimport \"core-js/modules/es6.array.map\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//引入鹰眼图组件\nimport MiniMap from 'leaflet-minimap';\nimport 'leaflet-minimap/dist/Control.MiniMap.min.css';\nexport default {\n  name: \"Main\",\n  data: function data() {\n    return {\n      map: \"\",\n      //地图\n      trajIcon: \"\",\n      //图标\n      // point: \"\"\n      menu_content: [//导航栏菜单内容\n      {\n        name: \"船舶交通网络\"\n      }, {\n        name: \"轨迹聚类\"\n      }],\n      tianditu_1_tile: \"\",\n      //天地图矢量底图\n      tianditu_1_marker: \"\",\n      //天地图矢量标记\n      tianditu_2_tile: \"\",\n      //天地图影像底图\n      tianditu_2_marker: \"\",\n      //天地图影像标记\n      tianditu_3_tile: \"\",\n      //天地图地形底图\n      tianditu_3_marker: \"\",\n      //天地图地形标记\n      basicLayer: \"\",\n      //底图图层\n      markerLayer: \"\",\n      //注解图层\n      loading: true,\n      //加载动画\n      drawer: false //抽屉显示 \n\n    };\n  },\n  methods: {\n    //跳转到登录界面\n    skipToLogin: function skipToLogin() {\n      this.$router.push(\"/login\");\n    },\n    //注销\n    logout: function logout() {\n      localStorage.removeItem(\"Flag\");\n      this.$store.dispatch(\"userLogin\", false);\n    },\n    //初始化地图\n    initMap: function initMap() {\n      //初始化地图对象\n      this.map = L.map(\"map\", {\n        center: [40.02404009136253, 116.50641060224784],\n        //地图中心\n        zoom: 11,\n        //缩放比例\n        // zoomControl: false,     //禁用 + - 按钮\n        doubleClickZoom: false,\n        //禁用双击放大\n        attributionControl: false //移除右下角Leaflet标识\n\n      }); //初始化地图图层（墨卡托坐标）\n\n      this.tianditu_1_tile = \"http://t4.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\n      this.tianditu_1_marker = \"http://t4.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\n      this.tianditu_2_tile = \"http://t4.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\n      this.tianditu_2_marker = \"http://t4.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\n      this.tianditu_3_tile = \"http://t4.tianditu.gov.cn/DataServer?T=ter_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\n      this.tiandutu_3_marker = \"http://t4.tianditu.gov.cn/DataServer?T=cta_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\"; //天地图影像图底图（墨卡托坐标）\n\n      this.basicLayer = L.tileLayer(this.tianditu_1_tile).addTo(this.map); //天地图影像图标记（墨卡托坐标）\n\n      this.markLayer = L.tileLayer(this.tianditu_1_marker).addTo(this.map); // this.map.removeLayer(name);     //移除图层\n      //初始化图标\n\n      this.trajIcon = L.divIcon({\n        className: 'my-div-icon',\n        //自定义icon css样式\n        iconSize: [15, 15] //点大小\n\n      }); //添加鹰眼图\n\n      var osmUrl = \"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}\"; //ArcGis地图\n\n      var osm = new L.tileLayer(osmUrl, {\n        minZoom: 0,\n        maxZoom: 13\n      });\n      var miniMap = new MiniMap(osm, {\n        toggleDisplay: true,\n        width: 300,\n        height: 300\n      }).addTo(this.map); //初始化调用轨迹数据\n\n      this.getTrajData(); //初始化绘制轨迹\n\n      this.drawTrajectory();\n      var that = this; //拖动地图事件\n\n      this.map.on(\"moveend\", function (e) {\n        that.getTrajData();\n      }); //地图点击事件\n\n      var clickpop = L.popup();\n      this.map.on(\"click\", function (e) {\n        var content = \"经度：\" + e.latlng.lng + \"<br/>纬度：\" + e.latlng.lat;\n        clickpop.setLatLng(e.latlng).setContent(content).openOn(that.map);\n      }); //关闭加载动画\n\n      this.loading = false;\n    },\n    //读取轨迹数据\n    getTrajData: function getTrajData() {\n      this.loading = true; //开启加载动画\n\n      var leftdown_lng = this.map.getBounds().getSouthWest().lng; //左下角经度\n\n      var leftdown_lat = this.map.getBounds().getSouthWest().lat; //左下角纬度\n\n      var rightup_lng = this.map.getBounds().getNorthEast().lng; //右上角经度\n\n      var rightup_lat = this.map.getBounds().getNorthEast().lat; //右上角纬度\n      // console.log(leftdown_lat)\n      //向后端发送请求，读取轨迹数据\n      //模拟JSON获取轨迹数据\n\n      var group = L.layerGroup().addTo(this.map); //图层组\n\n      this.axios.get('/point.json').then(function (response) {\n        var point = response.data; //全部轨迹数据\n\n        for (var i = 0; i < point.length; i++) {\n          var lon = point[i].lon;\n          var lat = point[i].lat;\n          var marker = L.marker([lon, lat], {\n            icon: this.trajIcon\n          }).addTo(group);\n        }\n      }.bind(this)).catch(function (error) {\n        console.log(error);\n      });\n      this.loading = false; //关闭加载动画\n    },\n    //切换地图\n    changeMap: function changeMap(command) {\n      this.loading = true; //开启加载动画\n\n      if (command == \"tianditu_1\") {\n        this.basicLayer.setUrl(this.tianditu_1_tile, false);\n        this.markLayer.setUrl(this.tianditu_1_marker, false);\n      } else if (command == \"tianditu_2\") {\n        this.basicLayer.setUrl(this.tianditu_2_tile, false);\n        this.markLayer.setUrl(this.tianditu_2_marker, false);\n      } else {\n        this.basicLayer.setUrl(this.tianditu_3_tile, false);\n        this.markLayer.setUrl(this.tianditu_3_marker, false);\n      }\n\n      this.loading = false; //关闭加载动画\n    },\n    //绘制轨迹\n    drawTrajectory: function drawTrajectory() {\n      this.loading = true; //开启加载动画\n\n      var latlngs = [[[17.385044, 78.486671], [16.506174, 80.648015], [17.686816, 83.218482]], [[13.082680, 80.270718], [12.971599, 77.594563], [15.828126, 78.037279]]];\n      var multiPolyLineOptions = {\n        color: 'red'\n      };\n      var multiPolyline = L.polyline(latlngs, multiPolyLineOptions);\n      multiPolyline.addTo(this.map);\n      this.loading = false; //关闭加载动画\n    }\n  },\n  mounted: function mounted() {\n    this.initMap();\n  }\n};",{"version":3,"sources":["Main.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-container>\r\n\t\t\t<!-- 导航栏 -->\r\n\t\t\t<el-header style=\"background-color: #18223d;height: calc(5vh);\">\r\n\t\t\t\t<!-- 此处写导航栏代码 -->\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<el-row type=\"flex\">\r\n\t\t\t\t\t\t<el-col :span=\"20\" class=\"hidden-sm-and-down\">\r\n\t\t\t\t\t\t\t<el-menu class=\"el-menu-traj\"\r\n\t\t\t\t\t\t\t\t\tmode=\"horizontal\"\r\n\t\t\t\t\t\t\t\t\tbackground-color=\"#18223d\"\r\n\t\t\t\t\t\t\t\t\ttext-color=\"#fffefd\"\r\n\t\t\t\t\t\t\t\t\tactive-text-color=\"#ffffff\"\r\n\t\t\t\t\t\t\t\t\tstyle=\"border-bottom: none;\">\r\n\t\t\t\t\t\t\t\t<el-row type=\"flex\">\r\n\t\t\t\t\t\t\t\t\t<!-- 标题 -->\r\n\t\t\t\t\t\t\t\t\t<el-col :span=\"7\">\r\n\t\t\t\t\t\t\t\t\t\t<el-menu-item>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"title-span\">船舶轨迹大数据可视化系统</div>\r\n\t\t\t\t\t\t\t\t\t\t</el-menu-item>\r\n\t\t\t\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t\t\t\t<!-- 菜单 -->\r\n\t\t\t\t\t\t\t\t\t<el-col :span=\"1.5\" v-for=\"menu_item in menu_content\">\r\n\t\t\t\t\t\t\t\t\t\t<el-menu-item>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"func-span\">{{menu_item.name}}</div>\r\n\t\t\t\t\t\t\t\t\t\t</el-menu-item>\r\n\t\t\t\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t\t\t\t<!-- 切换地图 -->\r\n\t\t\t\t\t\t\t\t\t<el-col :span=\"1.5\">\r\n\t\t\t\t\t\t\t\t\t\t<el-menu-item>\r\n\t\t\t\t\t\t\t\t\t\t\t<!-- 切换地图下拉菜单 -->\r\n\t\t\t\t\t\t\t\t\t\t\t<el-dropdown @command=\"changeMap\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"func-span\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t切换地图<i class=\"el-icon-arrow-down el-icon--right\"></i> \r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<el-dropdown-menu slot=\"dropdown\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<el-dropdown-item icon=\"el-icon-circle-check\" command=\"tianditu_1\">天地图街道图</el-dropdown-item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<el-dropdown-item icon=\"el-icon-circle-check\" command=\"tianditu_2\">天地图影像图</el-dropdown-item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<el-dropdown-item icon=\"el-icon-circle-check\" command=\"tianditu_3\">天地图地形图</el-dropdown-item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</el-dropdown-menu>\r\n\t\t\t\t\t\t\t\t\t\t\t</el-dropdown>\r\n\t\t\t\t\t\t\t\t\t\t</el-menu-item>\r\n\t\t\t\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t\t\t</el-row>\r\n\t\t\t\t\t\t\t</el-menu>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t<!-- 菜单图标 -->\r\n\t\t\t\t\t\t<el-col :xs=\"9\" class=\"hidden-sm-and-up\">\r\n\t\t\t\t\t\t\t<div class=\"nav-icon\" @click=\"drawer = true\">\r\n\t\t\t\t\t\t\t\t<i class=\"el-icon-s-unfold\" style=\"font-size: 30px;\"></i>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t<!-- 登录 -->\r\n\t\t\t\t\t\t<el-col :span=\"4\" :xs=\"15\">\r\n\t\t\t\t\t\t\t<div class=\"rightsection\">\r\n\t\t\t\t\t\t\t\t<div v-if=\"$store.state.isLogin == true\">\r\n\t\t\t\t\t\t\t\t\t欢迎您，{{$store.state.userName}}\r\n\t\t\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"logout\" style=\"margin-left: 5px;\">退出</el-button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<span class=\"btn-click\" v-else @click=\"skipToLogin\">登录</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t</el-row>\r\n\t\t\t\t</div>\r\n\t\t\t</el-header>\r\n\t\t\t<!-- 主体部分 -->\r\n\t\t\t<el-main style=\"padding: 0;\">\r\n\t\t\t\t<div id=\"map\" v-loading=\"loading\" element-loading-text=\"拼命加载中\" element-loading-spinner=\"el-icon-loading\" element-loading-background=\"rgba(0, 0, 0, 0.8)\"></div>\r\n\t\t\t</el-main>\r\n\t\t</el-container>\r\n\t</div>\r\n\t\r\n</template>\r\n\r\n<script>\r\n//引入鹰眼图组件\r\nimport MiniMap from 'leaflet-minimap'\r\nimport 'leaflet-minimap/dist/Control.MiniMap.min.css'\r\nexport default {\r\n\tname: \"Main\",\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmap: \"\",     //地图\r\n\t\t\ttrajIcon: \"\",     //图标\r\n\t\t\t// point: \"\"\r\n\t\t\tmenu_content: [      //导航栏菜单内容\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"船舶交通网络\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"轨迹聚类\"\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\ttianditu_1_tile: \"\",     //天地图矢量底图\r\n\t\t\ttianditu_1_marker: \"\",      //天地图矢量标记\r\n\t\t\ttianditu_2_tile: \"\",     //天地图影像底图\r\n\t\t\ttianditu_2_marker: \"\",      //天地图影像标记\r\n\t\t\ttianditu_3_tile: \"\",     //天地图地形底图\r\n\t\t\ttianditu_3_marker: \"\",      //天地图地形标记\r\n\t\t\tbasicLayer: \"\",       //底图图层\r\n\t\t\tmarkerLayer: \"\",      //注解图层\r\n\t\t\tloading: true,        //加载动画\r\n\t\t\tdrawer: false         //抽屉显示 \r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t//跳转到登录界面\r\n\t\tskipToLogin() {\r\n\t\t\tthis.$router.push(\"/login\");\r\n\t\t},\r\n\t\t//注销\r\n\t\tlogout() {\r\n\t\t\tlocalStorage.removeItem(\"Flag\");\r\n\t\t\tthis.$store.dispatch(\"userLogin\", false);\r\n\t\t},\r\n\t\t//初始化地图\r\n\t\tinitMap() {\r\n\t\t\t//初始化地图对象\r\n\t\t\tthis.map = L.map(\"map\", {\r\n\t\t\t\tcenter: [40.02404009136253, 116.50641060224784],     //地图中心\r\n\t\t\t\tzoom: 11,    //缩放比例\r\n\t\t\t\t// zoomControl: false,     //禁用 + - 按钮\r\n\t\t\t\tdoubleClickZoom: false,    //禁用双击放大\r\n\t\t\t\tattributionControl: false     //移除右下角Leaflet标识\r\n\t\t\t});\r\n\t\t\t//初始化地图图层（墨卡托坐标）\r\n\t\t\tthis.tianditu_1_tile = \"http://t4.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\r\n\t\t\tthis.tianditu_1_marker = \"http://t4.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\r\n\t\t\tthis.tianditu_2_tile = \"http://t4.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\r\n\t\t\tthis.tianditu_2_marker = \"http://t4.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\r\n\t\t\tthis.tianditu_3_tile = \"http://t4.tianditu.gov.cn/DataServer?T=ter_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\r\n\t\t\tthis.tiandutu_3_marker = \"http://t4.tianditu.gov.cn/DataServer?T=cta_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\";\r\n\t\t\t//天地图影像图底图（墨卡托坐标）\r\n\t\t\tthis.basicLayer = L.tileLayer(\r\n\t\t\t\tthis.tianditu_1_tile,\r\n\t\t\t).addTo(this.map);\r\n\t\t\t\r\n\t\t\t//天地图影像图标记（墨卡托坐标）\r\n\t\t\tthis.markLayer = L.tileLayer(\r\n\t\t\t\tthis.tianditu_1_marker,\r\n\t\t\t).addTo(this.map);\r\n\t\t\t// this.map.removeLayer(name);     //移除图层\r\n\t\t\t\r\n\t\t\t//初始化图标\r\n\t\t\tthis.trajIcon = L.divIcon({\r\n\t\t\t\tclassName: 'my-div-icon',     //自定义icon css样式\r\n\t\t\t\ticonSize: [15, 15]     //点大小\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//添加鹰眼图\r\n\t\t\tvar osmUrl = \"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}\";     //ArcGis地图\r\n\t\t\tvar osm = new L.tileLayer(osmUrl, {minZoom: 0, maxZoom: 13});\r\n\t\t\tvar miniMap = new MiniMap(osm, {toggleDisplay: true, width: 300, height: 300}).addTo(this.map);\r\n\t\t\t\r\n\t\t\t//初始化调用轨迹数据\r\n\t\t\tthis.getTrajData();\r\n\t\t\t\r\n\t\t\t//初始化绘制轨迹\r\n\t\t\tthis.drawTrajectory();\r\n\t\t\t\r\n\t\t\tvar that = this;\r\n\t\t\t//拖动地图事件\r\n\t\t\tthis.map.on(\"moveend\", function(e){\r\n\t\t\t\tthat.getTrajData();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//地图点击事件\r\n\t\t\tvar clickpop = L.popup();\r\n\t\t\tthis.map.on(\"click\", function(e){\r\n\t\t\t\tvar content = \"经度：\" + e.latlng.lng + \"<br/>纬度：\" + e.latlng.lat;\r\n\t\t\t\tclickpop.setLatLng(e.latlng).setContent(content).openOn(that.map);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//关闭加载动画\r\n\t\t\tthis.loading = false;\r\n\t\t},\r\n\t\t//读取轨迹数据\r\n\t\tgetTrajData() {\r\n\t\t\tthis.loading = true;     //开启加载动画\r\n\t\t\tvar leftdown_lng = this.map.getBounds().getSouthWest().lng;     //左下角经度\r\n\t\t\tvar leftdown_lat = this.map.getBounds().getSouthWest().lat;     //左下角纬度\r\n\t\t\tvar rightup_lng = this.map.getBounds().getNorthEast().lng;      //右上角经度\r\n\t\t\tvar rightup_lat = this.map.getBounds().getNorthEast().lat;      //右上角纬度\r\n\t\t\t// console.log(leftdown_lat)\r\n\t\t\t//向后端发送请求，读取轨迹数据\r\n\t\t\t\r\n\t\t\t//模拟JSON获取轨迹数据\r\n\t\t\tvar group = L.layerGroup().addTo(this.map);      //图层组\r\n\t\t\tthis.axios.get('/point.json')\r\n\t\t\t.then(function(response){\r\n\t\t\t\tvar point = response.data;     //全部轨迹数据\r\n\t\t\t\tfor(var i=0; i<point.length; i++){\r\n\t\t\t\t\tvar lon = point[i].lon;\r\n\t\t\t\t\tvar lat = point[i].lat;\r\n\t\t\t\t\tvar marker = L.marker([lon, lat], {\r\n\t\t\t\t\t\ticon: this.trajIcon,\r\n\t\t\t\t\t}).addTo(group);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this))\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tthis.loading = false;     //关闭加载动画\r\n\t\t},\r\n\t\t//切换地图\r\n\t\tchangeMap(command) {\r\n\t\t\tthis.loading = true;      //开启加载动画\r\n\t\t\tif(command == \"tianditu_1\"){\r\n\t\t\t\tthis.basicLayer.setUrl(this.tianditu_1_tile, false);\r\n\t\t\t\tthis.markLayer.setUrl(this.tianditu_1_marker, false);\r\n\t\t\t}else if(command == \"tianditu_2\"){\r\n\t\t\t\tthis.basicLayer.setUrl(this.tianditu_2_tile, false);\r\n\t\t\t\tthis.markLayer.setUrl(this.tianditu_2_marker, false);\r\n\t\t\t}else{\r\n\t\t\t\tthis.basicLayer.setUrl(this.tianditu_3_tile, false);\r\n\t\t\t\tthis.markLayer.setUrl(this.tianditu_3_marker, false);\r\n\t\t\t}\r\n\t\t\tthis.loading = false;       //关闭加载动画\r\n\t\t},\r\n\t\t//绘制轨迹\r\n\t\tdrawTrajectory() {\r\n\t\t\tthis.loading = true;        //开启加载动画\r\n\t\t\tvar latlngs = [\r\n\t\t\t    [[17.385044, 78.486671], [16.506174, 80.648015], [17.686816, 83.218482]],\r\n\t\t\t    [[13.082680, 80.270718], [12.971599, 77.594563],[15.828126, 78.037279]]\r\n\t\t\t];\r\n\t\t\tvar multiPolyLineOptions = {color: 'red'};\r\n\t\t\tvar multiPolyline = L.polyline(latlngs, multiPolyLineOptions);\r\n\t\t\tmultiPolyline.addTo(this.map);\r\n\t\t\tthis.loading = false;         //关闭加载动画\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.initMap();\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n* {\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n}\r\n.title-span {\r\n\tfont-size: 25px;\r\n\ttext-align: left;\r\n\tfont-weight: bold;\r\n\tline-height: calc(5vh);\r\n\toverflow: hidden;\r\n}\r\n.func-span {\r\n\ttext-align: center;\r\n\tfont-size: 18px;\r\n\tline-height: calc(5vh);\r\n\tcolor: #ffffff;\r\n}\r\n.el-menu-item:hover {\r\n\tbackground-color: rgba($color: #ffffff, $alpha: 0.2) !important;\r\n}\r\n.rightsection {\r\n\ttext-align: right;\r\n\tline-height: calc(5vh);\r\n\tfont-size: 18px;\r\n\tcolor: #ffffff;\r\n}\r\n.btn-click:hover {\r\n\tpadding: 15px;\r\n\tcursor: pointer;\r\n\tbackground-color: rgba($color: #ffffff, $alpha: 0.2);\r\n}\r\n.el-icon-arrow-down {\r\n\tfont-size: 12px;\r\n}\r\n.nav-icon {\r\n\tcolor: #ffffff;\r\n\tline-height: calc(5vh);\r\n}\r\n.nav-icon:hover {\r\n\tcursor: pointer;\r\n}\r\n#map {\r\n\twidth: 100%;\r\n\theight: calc(95vh);\r\n\tz-index: 1;\r\n}\r\n.my-div-icon {\r\n\twidth: 15px;\r\n\theight: 15px;\r\n\tbackground-color: red;\r\n\tborder-radius: 50%;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views"}]}