{"remainingRequest":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\src\\views\\Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\src\\views\\Main.vue","mtime":1625454428895},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1625218015435},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\babel-loader\\lib\\index.js","mtime":1625218015245},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1625218015435},{"path":"D:\\trajVisualApp\\trajVisualApp\\前端\\trajVisualApp\\node_modules\\vue-loader\\lib\\index.js","mtime":1625218023348}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nexport default {\r\n\tname: \"Main\",\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmap: \"\",\r\n\t\t\ttrajIcon: \"\",\r\n\t\t\t// point: \"\"\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t//跳转到登录界面\r\n\t\tskipToLogin() {\r\n\t\t\tthis.$router.push(\"/login\");\r\n\t\t},\r\n\t\t//注销\r\n\t\tlogout() {\r\n\t\t\tlocalStorage.removeItem(\"Flag\");\r\n\t\t\tthis.$store.dispatch(\"userLogin\", false);\r\n\t\t},\r\n\t\t//初始化地图\r\n\t\tinitMap() {\r\n\t\t\tthis.map = L.map(\"map\", {\r\n\t\t\t\tcenter: [40.02404009136253, 116.50641060224784],     //地图中心\r\n\t\t\t\tzoom: 11,    //缩放比例\r\n\t\t\t\t// zoomControl: false,     //禁用 + - 按钮\r\n\t\t\t\tdoubleClickZoom: false,    //禁用双击放大\r\n\t\t\t\tattributionControl: false     //移除右下角Leaflet标识\r\n\t\t\t});\r\n\t\t\t//天地图影像图底图（墨卡托坐标）\r\n\t\t\tlet basicLayer = L.tileLayer(\r\n\t\t\t\t\"http://t4.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\",\r\n\t\t\t).addTo(this.map);\r\n\t\t\t//天地图影像图标记（墨卡托坐标）\r\n\t\t\tlet markLayer = L.tileLayer(\r\n\t\t\t\t\"http://t4.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\"\r\n\t\t\t).addTo(this.map);\r\n\t\t\t// this.map.removeLayer(name);     //移除图层\r\n\t\t\t\r\n\t\t\t//初始化图标\r\n\t\t\tthis.trajIcon = L.divIcon({\r\n\t\t\t\tclassName: 'my-div-icon',     //自定义icon css样式\r\n\t\t\t\ticonSize: [15, 15]     //点大小\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//初始化调用数据\r\n\t\t\tthis.getTrajData();\r\n\t\t\t\r\n\t\t\tvar that = this;\r\n\t\t\t//缩放事件(与拖动地图事件重复)\r\n\t\t\t// this.map.on(\"zoomend\", function(e){\r\n\t\t\t// \t// var zoom_val = e.target.getZoom();     //获取缩放级别\r\n\t\t\t// \tthat.getTrajData();\r\n\t\t\t// });\r\n\t\t\t//拖动地图事件\r\n\t\t\tthis.map.on(\"moveend\", function(e){\r\n\t\t\t\tthat.getTrajData();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\t//读取轨迹数据\r\n\t\tgetTrajData() {\r\n\t\t\tvar leftdown_lng = this.map.getBounds().getSouthWest().lng;     //左下角经度\r\n\t\t\tvar leftdown_lat = this.map.getBounds().getSouthWest().lat;     //左下角纬度\r\n\t\t\tvar rightup_lng = this.map.getBounds().getNorthEast().lng;      //右上角经度\r\n\t\t\tvar rightup_lat = this.map.getBounds().getNorthEast().lat;      //右上角纬度\r\n\t\t\t// console.log(leftdown_lat)\r\n\t\t\t//向后端发送请求，读取轨迹数据\r\n\t\t\t\r\n\t\t\t//模拟JSON获取轨迹数据\r\n\t\t\tvar group = L.layerGroup().addTo(this.map);      //图层组\r\n\t\t\tthis.axios.get('/point.json')\r\n\t\t\t.then(function(response){\r\n\t\t\t\tvar point = response.data;     //全部轨迹数据\r\n\t\t\t\tfor(var i=0; i<point.length; i++){\r\n\t\t\t\t\tvar lon = point[i].lon;\r\n\t\t\t\t\tvar lat = point[i].lat;\r\n\t\t\t\t\tvar marker = L.marker([lon, lat], {\r\n\t\t\t\t\t\ticon: this.trajIcon,\r\n\t\t\t\t\t}).addTo(group);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this))\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.initMap();\r\n\t}\r\n}\r\n",{"version":3,"sources":["Main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA","file":"Main.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-container>\r\n\t\t\t<!-- 导航栏 -->\r\n\t\t\t<el-header style=\"background-color: #18223d;height: calc(5vh);\">\r\n\t\t\t\t<!-- 此处写导航栏代码 -->\r\n\t\t\t\t\r\n\t\t\t\t<!-- 登录 -->\r\n\t\t\t\t<p v-if=\"$store.state.isLogin == true\">\r\n\t\t\t\t\t欢迎您，{{$store.state.userName}}\r\n\t\t\t\t\t<button @click=\"logout\">注销</button>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p v-else @click=\"skipToLogin\">登录</p>\r\n\t\t\t</el-header>\r\n\t\t\t<!-- 主体部分 -->\r\n\t\t\t<el-main style=\"padding: 0;\">\r\n\t\t\t\t<div id=\"map\"></div>\r\n\t\t\t</el-main>\r\n\t\t</el-container>\r\n\t</div>\r\n\t\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tname: \"Main\",\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmap: \"\",\r\n\t\t\ttrajIcon: \"\",\r\n\t\t\t// point: \"\"\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t//跳转到登录界面\r\n\t\tskipToLogin() {\r\n\t\t\tthis.$router.push(\"/login\");\r\n\t\t},\r\n\t\t//注销\r\n\t\tlogout() {\r\n\t\t\tlocalStorage.removeItem(\"Flag\");\r\n\t\t\tthis.$store.dispatch(\"userLogin\", false);\r\n\t\t},\r\n\t\t//初始化地图\r\n\t\tinitMap() {\r\n\t\t\tthis.map = L.map(\"map\", {\r\n\t\t\t\tcenter: [40.02404009136253, 116.50641060224784],     //地图中心\r\n\t\t\t\tzoom: 11,    //缩放比例\r\n\t\t\t\t// zoomControl: false,     //禁用 + - 按钮\r\n\t\t\t\tdoubleClickZoom: false,    //禁用双击放大\r\n\t\t\t\tattributionControl: false     //移除右下角Leaflet标识\r\n\t\t\t});\r\n\t\t\t//天地图影像图底图（墨卡托坐标）\r\n\t\t\tlet basicLayer = L.tileLayer(\r\n\t\t\t\t\"http://t4.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\",\r\n\t\t\t).addTo(this.map);\r\n\t\t\t//天地图影像图标记（墨卡托坐标）\r\n\t\t\tlet markLayer = L.tileLayer(\r\n\t\t\t\t\"http://t4.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=efe5e7d29b0c9728d44edba8dc08c8d7\"\r\n\t\t\t).addTo(this.map);\r\n\t\t\t// this.map.removeLayer(name);     //移除图层\r\n\t\t\t\r\n\t\t\t//初始化图标\r\n\t\t\tthis.trajIcon = L.divIcon({\r\n\t\t\t\tclassName: 'my-div-icon',     //自定义icon css样式\r\n\t\t\t\ticonSize: [15, 15]     //点大小\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//初始化调用数据\r\n\t\t\tthis.getTrajData();\r\n\t\t\t\r\n\t\t\tvar that = this;\r\n\t\t\t//缩放事件(与拖动地图事件重复)\r\n\t\t\t// this.map.on(\"zoomend\", function(e){\r\n\t\t\t// \t// var zoom_val = e.target.getZoom();     //获取缩放级别\r\n\t\t\t// \tthat.getTrajData();\r\n\t\t\t// });\r\n\t\t\t//拖动地图事件\r\n\t\t\tthis.map.on(\"moveend\", function(e){\r\n\t\t\t\tthat.getTrajData();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\t//读取轨迹数据\r\n\t\tgetTrajData() {\r\n\t\t\tvar leftdown_lng = this.map.getBounds().getSouthWest().lng;     //左下角经度\r\n\t\t\tvar leftdown_lat = this.map.getBounds().getSouthWest().lat;     //左下角纬度\r\n\t\t\tvar rightup_lng = this.map.getBounds().getNorthEast().lng;      //右上角经度\r\n\t\t\tvar rightup_lat = this.map.getBounds().getNorthEast().lat;      //右上角纬度\r\n\t\t\t// console.log(leftdown_lat)\r\n\t\t\t//向后端发送请求，读取轨迹数据\r\n\t\t\t\r\n\t\t\t//模拟JSON获取轨迹数据\r\n\t\t\tvar group = L.layerGroup().addTo(this.map);      //图层组\r\n\t\t\tthis.axios.get('/point.json')\r\n\t\t\t.then(function(response){\r\n\t\t\t\tvar point = response.data;     //全部轨迹数据\r\n\t\t\t\tfor(var i=0; i<point.length; i++){\r\n\t\t\t\t\tvar lon = point[i].lon;\r\n\t\t\t\t\tvar lat = point[i].lat;\r\n\t\t\t\t\tvar marker = L.marker([lon, lat], {\r\n\t\t\t\t\t\ticon: this.trajIcon,\r\n\t\t\t\t\t}).addTo(group);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this))\r\n\t\t\t.catch(function(error){\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.initMap();\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n* {\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n}\r\np {\r\n\tcolor: #FFFFFF;\r\n}\r\np:hover {\r\n\tcursor: pointer;\r\n}\r\n#map {\r\n\twidth: 100%;\r\n\theight: calc(95vh);\r\n\tz-index: 1;\r\n}\r\n.my-div-icon {\r\n\twidth: 15px;\r\n\theight: 15px;\r\n\tbackground-color: red;\r\n\tborder-radius: 50%;\r\n}\r\n</style>\r\n"]}]}